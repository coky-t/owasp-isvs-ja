# V5: ハードウェアプラットフォーム要件

## 管理目標

ハードウェアはソフトウェアよりも侵害および破壊が難しくコストがかかります。したがってハードウェアセキュリティは組み込みデバイスセキュリティに対する堅牢な基盤を提供できます。一方で、バックドアや文書化されていないデバッグ機能を含むハードウェアは、スタックの他のレイヤーで適切なセキュリティ対策が講じられている場合でも、デバイス全体のセキュリティを完全に危殆化する可能性があります。

この章に記されているコントロールの目的は、ハードウェアがセキュアな構成に使用できる限り、可能な限り最もセキュアな方法で構成されることを確保することです。これにはデバッグインタフェースの無効化または保護、改竄に対抗するための既存のすべてのアラームとセンサーメカニズムの設定、OTP フューズなどのアンチクローニングハードウェア保護の使用、セキュアなプロセス分離のための MMU (メモリ管理ユニット) の使用が含まれます。

この章ではセキュアな構成を保証し、耐性を強化するために階層化されたコントロールを提供するハードウェアプラットフォームに対する要件について説明します。たとえば、3.1.4 ではセキュアブートを正しく構成する方法について説明しています。5.1.2 ではこれをサポートするプラットフォームが必要です。5.1.1 ではプラットフォームがデバッグインタフェースの無効化をサポートしている必要があり、1.2.4 では出荷時にこれを適用する必要があります。5.1.8 では MMU プラットフォームサポートが必要であり、3.2.8 ではメモリ保護の設定と適用が必要です。

## セキュリティ検証要件

### 設計

| # | 説明 | L1 | L2 | L3 |
| -- | ---------------------- | - | - | - |
| **5.1.1** | プラットフォームがデバッグインタフェース (例 JTAG, SWD, UART など) へのアクセスの無効化または保護をサポートしていることを検証します。 | | ✓ | ✓ |
| **5.1.2** | プラットフォームがファーストステージブートローダーの真正性の妥当性確認をサポートしていることを検証します。 | | ✓ | ✓ |
| **5.1.3** | メインチップや外部セキュリティチップの専用機能を活用するプラットフォームにより暗号化アクセラレータ機能が提供されていることを検証します。 | | ✓ | ✓ |
| **5.1.4** | 専用のハードウェアセキュリティ機能を利用して、秘密鍵や証明書などの機密データを安全に保存できることを検証します。 | | ✓ | ✓ |
| **5.1.5** | (OTP フューズを燃やすなどにより) プラットフォームのプラットフォームセキュリティ構成をロックできることを検証します。 | | ✓ | ✓ |
| **5.1.6** | デバッグヘッダが PCB から削除されていることを検証します。 | | ✓ | ✓ |
| **5.1.7** | ハードウェアに、特定の機能を有効または無効にできる特別なピン構成など、非公式に文書化されたデバッグ機能がないことを検証します。 | | ✓ | ✓ |
| **5.1.8** | 機密性の高いメモリ領域を分離するためにメモリ管理ユニット (MMU) を使用して、プラットフォームがメモリおよび I/O 保護機能をサポートしていることを検証します。 | | ✓ | ✓ |
| **5.1.9** | プラットフォームが物理的なディーキャプサレイション、サイドチャネル、グリッチ攻撃に対する保護を提供していることを検証します。 | | | ✓ |
| **5.1.10** | 説明的なシルクスクリーンが PCB から除去されていることを検証します。 | | | ✓ |
| **5.1.11** | デバッグパスとトレースが製品 PCB から取り外されていることを検証します。 | | | ✓ |
| **5.1.12** | FPGA ビットストリームが強力でセキュアなアルゴリズムを使用して暗号化されていることを検証します。 | | | ✓ |

## 参考情報
詳細については、以下も参照してください。

- Common Weakness Enumeration (CWE) Hardware Design: <https://cwe.mitre.org/data/definitions/1194.html>
- IoT Security - Physical and Hardware Security: <https://www.embedded.com/iot-security-physical-and-hardware-security/>
- IETF RFC 8576 - IoT Security: State of the Art and Challenges (5.10 Reverse Engineering Considerations): <https://tools.ietf.org/html/rfc8576>
- ENISA - Baseline Security Recommendations for IoT: <https://www.enisa.europa.eu/publications/baseline-security-recommendations-for-iot/at_download/fullReport>
- GSMA - IoT Security Guidelines for Endpoint Systems: <https://www.gsma.com/iot/wp-content/uploads/2017/10/CLP.13-v2.0.pdf>
- NSA Hardware and Firmware Security Guidance: <https://github.com/nsacyber/Hardware-and-Firmware-Security-Guidance>
