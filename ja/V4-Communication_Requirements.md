# V4: 通信要件

## 管理目標

## セキュリティ検証要件

### 一般

| # | 説明 | L1 | L2 | L3 |
| --  | ---------------------- | - | - | - |
| **4.1.1** | IoT エコシステムの他のコンポーネント (センサー、ゲートウェイ、サポートクラウドなど) との通信が、データの機密性と完全性が保証され、通信プロトコルにリプレイ攻撃に対する保護が組み込まれている安全なチャネルを介して行われることを検証します。TLS などの実績のあるテクノロジを利用します。 | ✓ | ✓ | ✓ |
| **4.1.2** | TLS を使用する場合は安全に構成されていることを検証します。 | ✓ | ✓ | ✓ |
| **4.1.3** | TLS を使用する場合はデバイスが X.509 証明書を暗号で検証することを検証します。カスタム検証スキームが使用されていないことを確認します。 | ✓ | ✓ | ✓ |
| **4.1.4** | 可用性が重要なアプリケーションについて、妨害からの保護または検出が提供されていることを検証します。 | ✓ | ✓ | ✓ |
| **4.1.5** | 受信したデータの真正性が暗号で検証されていることを検証します。 | ✓ | ✓ | ✓ |
| **4.1.6** | TLS を使用する場合はデバイスが独自の証明書ストアを使用するか、またはエンドポイント証明書または公開鍵をピン留めしていること、それに加えて、信頼できる CA により署名されている場合でも、異なる証明書または鍵を提供するエンドポイントとの接続を確立しないことを検証します。 | ✓ | ✓ | ✓ |

### マシン間

| # | 説明 | L1 | L2 | L3 |
| --  | ---------------------- | - | - | - |
| **4.2.1** | すべての TCP ベースの通信 (REST, MQTT, AMQP など) が X.509 認証済みのトランスポート層セキュリティ (Transport Layer Security, TLS) を使用してシステムコンポーネント間で暗号化されていることを検証します。 | ✓ | ✓ | ✓ |
| **4.2.2** | すべての UDP ベースの通信 (Constrained Application Protocol (CoAP) など) が IETF RFC 7525 以降で規定されているデータグラムトランスポート層セキュリティ (Datagram Transport Layer Security, DTLS) を使用していることを検証します。 | ✓ | ✓ | ✓ |
| **4.2.3** | 暗号化されていない通信が機密性の低いデータと命令に限定されていることを検証します。 | ✓ | ✓ | ✓ |
| **4.2.4** | 共有シークレットを使用して暗号で通信を保護する場合は、各デバイスやセンサーに同じ鍵がハードコードされていないことを検証します。 | ✓ | ✓ | ✓ |
| **4.2.5** | MQTT ブローカーが認可された IoT デバイスのみにメッセージトピックのサブスクライブおよびパブリッシュを許可していることを検証します。 | ✓ | ✓ | ✓ |
| **4.2.6** | 機密情報を含むすべての MQTT メッセージが TLS を使用して暗号化されていることを検証します。 | ✓ | ✓ | ✓ |
| **4.2.7** | ネイティブのユーザー名とパスワードの機能ではなく、証明書が MQTT トランザクションの認証に使用されていることを検証します。 | ✓ | ✓ | ✓ |

### Bluetooth

| # | 説明 | L1 | L2 | L3 |
| --  | ---------------------- | - | - | - |
| **4.3.1** | 必要な場合を除いて Bluetooth デバイスでペアリングと検出がブロックされていることを検証します。 | ✓ | ✓ | ✓ |
| **4.3.2** | PIN または PassKey コードが簡単に推測できないことを検証します。たとえば、PIN コードが '0000' や '1234' ではないことを検証します。 | ✓ | ✓ | ✓ |
| **4.3.3** | 古いバージョンの Bluetooth の場合、およびシンプルモードの認証がサポートされている場合は、デバイスをペアリングするために PIN が必要であることを検証します。 | ✓ | ✓ | ✓ |
| **4.3.4** | 最新バージョンの Bluetooth の場合、"Just Works" を除くすべてのバージョンで Secure Simple Pairing (SSP) 認証に少なくとも 6 桁が必要であることを検証します。 | ✓ | ✓ | ✓ |
| **4.3.5** | 暗号化鍵が最大許容サイズであることを検証します。Bluetooth にはセッションを確立するための構成可能な鍵サイズパラメータがあり、AES で使用される 16-32 バイトサイズよりも小さいサイズの鍵を許可する構成があります。 | ✓ | ✓ | ✓ |
| **4.3.6** | 利用可能な最も安全な Bluetooth ペアリング手法が使用されていることを検証します。通信デバイスの機能に応じて Out Of Band (OOB), Numeric Comparison, Passkey Entry ペアリング手法が使用されていることを検証します。 | ✓ | ✓ | ✓ |
| **4.3.7** | デバイスでサポートされている最適な Bluetooth セキュリティモードとレベルが使用されていることを検証します。 | ✓ | ✓ | ✓ |

### Wi-Fi

| # | 説明 | L1 | L2 | L3 |
| --  | ---------------------- | - | - | - |
| **4.4.1** | デバイス機能の一部として必要な場合を除き、Wi-Fi 接続が無効であることを検証します。ネットワーク接続を必要としないデバイスや、Ethernet など他のタイプのネットワーク接続をサポートするデバイスでは、Wi-Fi インタフェースを無効にする必要があります。 | ✓ | ✓ | ✓ |
| **4.4.2** | Wi-Fi 通信を保護するために WPA2 以降が使用されていることを検証します。 | ✓ | ✓ | ✓ |
| **4.4.2** | WPA が使用されている場合は、AES 暗号化 (CCMP モード) で使用されていることを検証します。 | ✓ | ✓ | ✓ |
| **4.4.2** | Wi-Fi 接続を確立するために Wi-Fi Protected Setup (WPS) がサポートされていないことを検証します。 | ✓ | ✓ | ✓ |


## 参考情報
