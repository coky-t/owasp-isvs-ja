# V3: ソフトウェアプラットフォーム要件

## 管理目標

## セキュリティ検証要件

### ブートローダー

| # | 説明 | L1 | L2 | L3 |
| --  | ---------------------- | - | - | - |
| **3.1.1** | ブートローダーが任意の場所からのコードのロードを許可していないことを検証します。場所にはストレージ (SD, USB, など) とネットワークロケーション (TCP/IP 経由) の両方が含まれます。 | ✓ | ✓ | ✓ |
| **3.1.2** | ブートローダー構成は製品リリースで不変であることを検証します。 | | ✓ | ✓ |
| **3.1.3** | デバイスのブートプロセスのすべてのステージにおいて USB, UART などの通信インタフェースが無効化または適切に保護されていることを検証します。 | | ✓ | ✓ |
| **3.1.4** | ファーストステージブートローダーの真正性が、構成を変更できない信頼できるコンポーネントにより検証されていることを検証します。 (セキュアブート、トラステッドブートなど)  | | ✓ | ✓ |
| **3.1.5** | ブートプロセスのすべてのステップにおいて次のブートローダーステージまたはアプリケーションコードの真正性が暗号で検証されていることを検証します。 | | ✓ | ✓ |
| **3.1.6** | デバイス起動の一部としてブートローダーステージに機密情報 (コンソールに記録された秘密鍵やパスワードなど) が含まれていないことを検証します。 | | ✓ | ✓ |
| **3.1.7** | ファームウェアが保存時に暗号化されたボリュームに保存されていることを検証します。 | | ✓ | ✓ |
| **3.1.8** | ブート時にダイレクトメモリアクセス (Direct Memory Access, DMA) が不可能であることを検証します。たとえば、PCI 接続を介して DMA が不可能であることを確認します。 | | ✓ | ✓ |


### OS コンフィグレーション

| # | 説明 | L1 | L2 | L3 |
| --  | ---------------------- | - | - | - |
| **3.2.1** | 組み込みオペレーティングシステムが業界のベストプラクティス、ベンチマークにしたがって構成され、安全なデフォルトを使用していることを検証します。 | ✓ | ✓ | ✓ |
| **3.2.2** | デバイスにより公開されているすべてのネットワークインタフェース上のすべてのネットワークサービスが必要なサービスであること、および不要なサービスが削除または無効化されていることを検証します。 | ✓ | ✓ | ✓ |
| **3.2.3** | OS カーネルとソフトウェアコンポーネントが最新であり、既知の脆弱性を含んでいないことを検証します。 | ✓ | ✓ | ✓ |
| **3.2.4** | Verify that persistent filesystem storage volumes are encrypted. | | ✓ | ✓ |
| **3.2.5** | デバイス上で実行されているアプリケーションが基盤となるオペレーティングシステムまたはカーネルのセキュリティ機能を使用していることを検証します。暗号化、鍵ストレージ、乱数生成、認証と認可、ログ記録、通信セキュリティを含みます。 | | ✓ | ✓ |
| **3.2.6** | アドレス空間配置のランダム化 (Address Space Layout Randomization, ASLR) や データ実行防止 (Data Execution Prevention, DEP) などのメモリ保護コントロールが組み込みオペレーティングシステムにより有効であることを検証します。 | | ✓ | ✓ |
| **3.2.7** | ハードウェアレベルのメモリ保護が使用され、特権レベルが適用されていることを検証します。 | ✓ | ✓ | ✓ |
| **3.2.8** | 組み込み OS が RAM への不正アクセス (RAM スクランブリングなど) に対する保護を提供していることを検証します。 | | | ✓ |
| **3.2.9** | 完全性測定アーキテクチャ (Integrity Measurement Architecture, IMA) が使用され、適切に構成されていることを検証します。 | | | ✓ |
| **3.2.10** | サードパーティアプリケーションとサービスがコンテナ化されたランタイム環境 (LXC, Docker など) 内で実行するように構成されていることを検証します。 | | | ✓ |

#### Linux

| # | 説明 | L1 | L2 | L3 |
| --  | ---------------------- | - | - | - |
| **3.3.1** | Linux カーネル名前空間を使用してプロセスが分離されていることを検証します。 | | ✓ | ✓ |
| **3.3.2** | コントロールグループ (cgroups) を使用して、重要なプロセスがリソースを制限するように構成されていることを検証します。 | | ✓ | ✓ |
| **3.3.4** | Linux カーネル機能が昇格されたアクセスを必要とするプロセスについて最小限のセットで構成されていることを検証します。 | | ✓ | ✓ |
| **3.3.5** | フィルタ付きセキュアコンピューティング (SECure COMPuting, seccomp BPF) が使用され、必要なシステムコールのみ許可するように構成されていることを検証します。 | | ✓ | ✓ |
| **3.3.6** | SELinux, AppArmor, GRSEC などのカーネルセキュリティモジュールの使用を検証します。 | | | ✓ |

### ソフトウェアアップデート

| # | 説明 | L1 | L2 | L3 |
| --  | ---------------------- | - | - | - |
| **3.4.1** | パッケージとユーザー空間アプリケーションがファームウェアアップデートから切り離された Over The Air アップデートを使用していることを検証します。 | | ✓ | ✓ |
| **3.4.2** | 事前定義されたスケジュールでデバイスを自動的にアップデートできることを検証します。 | ✓ | ✓ | ✓ |
| **3.4.3** | アップデートの真正性が信頼できるソースにより暗号で署名され、実行前に検証されていることを検証します。 | ✓ | ✓ | ✓ |
| **3.4.4** | アップデートプロセスが Time-of-Check Time-of-Use (TOCTOU) 攻撃に対して脆弱ではないことを検証します。これは一般的にアップデートの真正性を妥当性確認した直後にそのアップデートを適用することによって実現します。 | ✓ | ✓ | ✓ |
| **3.4.5** | アップデートがユーザーに通知することなくユーザーが構成した設定、セキュリティ、プライバシー設定を変更しないことを検証します。 | ✓ | ✓ | ✓ |
| **3.4.6** | デバイスを既知の脆弱なバージョンにダウングレードできないこと (アンチロールバック) を検証します。 | ✓ | ✓ | ✓ |
| **3.4.7** | アップデートに失敗した場合、デバイスがバックアップイメージに戻るか IoT エコシステムに通知することを検証します。 | ✓ | ✓ | ✓ |
| **3.4.8** | 署名されていないデバッグ用出荷前ファームウェアビルドをデバイスにフラッシュできないことを検証します。 | ✓ | ✓ | ✓ |
| **3.4.9** | 暗号化されたファームウェアイメージがデバイス上で安全に復号化されていることを検証します。 | ✓ | ✓ | ✓ |
| **3.4.10** | アップデートをダウンロードする前にデバイスがアップデートサーバーコンポーネントについて認証していることを検証します。 | ✓ | ✓ | ✓ |
| **3.4.11** | ファームウェアアップデートは暗号化されたサーバーサイドに保存されていることを検証します。 | ✓ | ✓ | ✓ |

### セキュリティチップ統合

| # | 説明 | L1 | L2 | L3 |
| --  | ---------------------- | - | - | - |
| **3.5.1** | セキュリティチップとその他のハードウェアコンポーネントとの間のバスで暗号化が使用されていることを検証します。 | | ✓ | ✓ |
| **3.5.2** | シリアルバスで暗号化を有効にするために使用される鍵 (共有鍵または秘密鍵) がホストで適切に保護されていることを検証します。 | | ✓ | ✓ |
| **3.5.3** | バス暗号化で使用されるデフォルトのベンダー鍵が製品ビルドで置き換えられていることを検証します。 | | ✓ | ✓ |
| **3.5.4** | ハードウェアセキュリティチップにより提供されている場合でも、新しいアプリケーションに非推奨で安全ではない暗号およびハッシュ関数 (3DES, SHA1 など) が使用されていないことを検証します。 | | ✓ | ✓ |

### カーネル空間アプリケーション要件

| # | 説明 | L1 | L2 | L3 |
| --  | ---------------------- | - | - | - |
| **3.6.1** | ロードされたカーネルモジュールが暗号で署名および検証されていることを検証します。 | | ✓ | ✓ |
| **3.6.2** | 実行時に必要なカーネルモジュールのみが有効であることを検証します。 | ✓ | ✓ | ✓ |

## 参考情報
詳細については、以下も参照してください。
- ENISA - Baseline Security Recommendations for IoT: <https://www.enisa.europa.eu/publications/baseline-security-recommendations-for-iot/at_download/fullReport>
- CIS Benchmarks: <https://www.cisecurity.org/cis-benchmarks/>
- TGC Guidance for Secure Update of Software and Firmware on Embedded Systems: <https://trustedcomputinggroup.org/wp-content/uploads/TCG-Secure-Update-of-SW-and-FW-on-Devices-v1r72_pub.pdf>
- U-Boot documentation - Signature: <https://github.com/u-boot/u-boot/blob/master/doc/uImage.FIT/signature.txt>
- GSMA - IoT Security Guidelines for Endpoint Systems: <https://www.gsma.com/iot/wp-content/uploads/2017/10/CLP.13-v2.0.pdf>
