# V3: ソフトウェアプラットフォーム要件

## 管理目標

## セキュリティ検証要件

### ブートローダー

| # | 説明 | L1 | L2 | L3 |
| --  | ---------------------- | - | - | - |
| **3.1.1** | デバイスのブートプロセスのすべてのステージにおいて USB, UART などの通信インタフェースが無効化または適切に保護されていることを検証します。 | ✓ | ✓ | ✓ |
| **3.1.2** | 構成を改竄できない信頼できるコンポーネントにより第一ステージブートローダーの真正性が検証されていることを検証します。 | ✓ | ✓ | ✓ |
| **3.1.3** | ブートプロセスのすべてのステップにおいて次のブートローダーステージまたはアプリケーションコードの真正性が暗号で検証されていることを検証します。 | ✓ | ✓ | ✓ |
| **3.1.4** | ブートローダーが任意の場所からのコードのロードを許可していないことを検証します。場所にはストレージ (SD, USB, など) とネットワークロケーション (TCP/IP 経由) の両方が含まれます。 | ✓ | ✓ | ✓ |
| **3.1.5** | ブートローダー構成は不変であることを検証します。 | ✓ | ✓ | ✓ |
| **3.1.6** | デバイス起動の一部としてブートローダーステージに機密情報 (コンソールに記録された秘密鍵やパスワードなど) が含まれていないことを検証します。 | ✓ | ✓ | ✓ |
| **3.1.7** | ファームウェアが保存時に暗号化されたボリュームに保存されていることを検証します。 | ✓ | ✓ | ✓ |

### OS コンフィグレーション

| # | 説明 | L1 | L2 | L3 |
| --  | ---------------------- | - | - | - |
| **3.2.1** | 組み込みオペレーティングシステムが業界のベストプラクティス、ベンチマークにしたがって構成され、安全なデフォルトを使用していることを検証します。 | ✓ | ✓ | ✓ |
| **3.2.2** | デバイスにより公開されているすべてのネットワークインタフェース上のすべてのネットワークサービスが必要なサービスであることを検証し、不要なサービスを削除します。 | ✓ | ✓ | ✓ |
| **3.2.3** | 使用されている OS カーネルとソフトウェアコンポーネントが最新であり、既知の脆弱性に対して脆弱ではないことを検証します。 | ✓ | ✓ | ✓ |
| **3.2.4** | デバイス上で実行されているアプリケーションが基盤となるオペレーティングシステムまたはカーネルのセキュリティ機能を使用していることを検証します。暗号化、鍵ストレージ、乱数生成、認証と認可、ログ記録、通信セキュリティを含みます。 | ✓ | ✓ | ✓ |
| **3.2.5** | アドレス空間配置のランダム化 (Address Space Layout Randomization, ASLR) や データ実行防止 (Data Execution Prevention, DEP) などのメモリ保護コントロールが組み込みオペレーティングシステムにより有効であることを検証します。 | ✓ | ✓ | ✓ |
| **3.2.6** | デバイスファームウェアが、アクセスを必要としないファームウェアの部分から特権コード、プロセスおよびデータを分離していることを検証します。セキュリティ機密コードやデータにアクセスする危殆化したコードの可能性を最小限に抑えるために、デバイスハードウェアは特権のないコードがセキュリティ機密コードにアクセスすることを防ぐための分離の概念を提供する必要があります。 | ✓ | ✓ | ✓ |
| **3.2.7** | 適用可能である場合には、専用のハードウェア機能を活用して分離の概念が提供されていることを検証します。 | ✓ | ✓ | ✓ |
| **3.2.8** | ハードウェアレベルのメモリ保護が使用され、特権レベルが適用されていることを検証します。 | ✓ | ✓ | ✓ |
| **3.2.9** | 組み込み OS が RAM への不正アクセス (RAM スクランブリングなど) に対する保護を提供していることを検証します。 | ✓ | ✓ | ✓ |
| **3.2.10** | 完全性測定アーキテクチャ (Integrity Measurement Architecture, IMA) が使用され、適切に構成されていることを検証します。 | ✓ | ✓ | ✓ |
| **3.2.11** | サードパーティアプリケーションとサービスがコンテナ化されたランタイム環境 (LXC, Docker など) 内で実行するように構成されていることを検証します。 | ✓ | ✓ | ✓ |
| **3.2.12** | 永続ファイルシステムのストレージボリュームが暗号化されていることを検証します。 | ✓ | ✓ | ✓ |

#### Linux

| # | 説明 | L1 | L2 | L3 |
| --  | ---------------------- | - | - | - |
| **3.3.1** | Linux カーネル名前空間を使用してプロセスが分離されていることを検証します。 | ✓ | ✓ | ✓ |
| **3.3.2** | コントロールグループ (cgroups) を使用して、重要なプロセスがリソースを制限するように構成されていることを検証します。 | ✓ | ✓ | ✓ |
| **3.3.3** | プロセスが root として実行されていないことを検証します。 | ✓ | ✓ | ✓ |
| **3.3.4** | Linux カーネル機能が昇格されたアクセスを必要とするプロセスについて最小限のセットで構成されていることを検証します。 | ✓ | ✓ | ✓ |
| **3.3.5** | SELinux, AppArmor, GRSEC などのカーネルセキュリティモジュールの使用を検証します。 | ✓ | ✓ | ✓ |
| **3.3.6** | フィルタ付きセキュアコンピューティング (SECure COMPuting, seccomp BPF) が使用され、必要なシステムコールのみ許可するように構成されていることを検証します。 | ✓ | ✓ | ✓ |

### ソフトウェアアップデート

| # | 説明 | L1 | L2 | L3 |
| --  | ---------------------- | - | - | - |
| **3.4.1** | パッケージとユーザー空間アプリケーションがファームウェアアップデートから切り離された Over The Air アップデートを使用していることを検証します。 | ✓ | ✓ | ✓ |
|**3.4.2**| 事前定義されたスケジュールでデバイスを自動的にアップデートできることを検証します。 | ✓ | ✓ | ✓ |
|**3.4.3**| アップデートの真正性が信頼できるソースにより暗号で署名され、実行前に検証されていることを検証します。 | ✓ | ✓ | ✓ |
|**3.4.4**| アップデートプロセスが Time-of-Check Time-of-Use (TOCTOU) 攻撃に対して脆弱ではないことを検証します。これは一般的にアップデートの真正性を妥当性確認した直後にそのアップデートを適用することによって実現します。 | ✓ | ✓ | ✓ |
|**3.4.5**| アップデートがユーザーに通知することなくユーザーが構成した設定、セキュリティ、プライバシー設定を変更しないことを検証します。 | ✓ | ✓ | ✓ |
|**3.4.6**| デバイスを既知の脆弱なバージョンにダウングレードできないこと (アンチロールバック) を検証します。 | ✓ | ✓ | ✓ |
|**3.4.7**| アップデートに失敗した場合、デバイスがバックアップイメージに戻るか IoT エコシステムに通知することを検証します。 | ✓ | ✓ | ✓ |
|**3.4.8**| 署名されていないデバッグ用出荷前ファームウェアビルドをデバイスにフラッシュできないことを検証します。 | ✓ | ✓ | ✓ |
|**3.4.9**| 暗号化されたファームウェアイメージがデバイス上で安全に復号化されていることを検証します。 | ✓ | ✓ | ✓ |
|**3.4.10**| アップデートをダウンロードする前にデバイスがアップデートサーバーコンポーネントについて認証していることを検証します。 | ✓ | ✓ | ✓ |
|**3.4.11**| ファームウェアアップデートは暗号化されたサーバーサイドに保存されていることを検証します。 | ✓ | ✓ | ✓ |

### TPM, SE およびその他のセキュアハードウェア統合

| # | 説明 | L1 | L2 | L3 |
| --  | ---------------------- | - | - | - |
| **3.5.1** | TPM, SE と MCU との間のバスで暗号化が使用されていることを検証します。 | ✓ | ✓ | ✓ |
| **3.5.2** | シリアルバスで暗号化を有効にするために使用される鍵 (共有鍵または秘密鍵) がホスト MCU 側で適切に保護されていることを検証します。 | ✓ | ✓ | ✓ |
| **3.5.3** | バス暗号化で使用されるデフォルトのベンダー鍵が製品ビルドで置き換えられていることを検証します。 | ✓ | ✓ | ✓ |
| **3.5.4** | SE により提供されている場合でも、新しいアプリケーションで非推奨または安全ではない暗号およびハッシュ関数 (3DES, SHA1 など) が使用されていないことを検証します。 | ✓ | ✓ | ✓ |
| **3.5.5** | SE により提供されたデータの真正性を検証するために署名 / Attestation などのメカニズムが使用されている場合は、その証拠が真正性とフレッシュネスについて正しく検証されていることを検証します。 | ✓ | ✓ | ✓ |
| **3.5.6** | SE がマルチテナント設定で使用されている場合は、個別のテナントに対して適切な認証とアクセス制御が使用されていることを検証します。個別のテナントが SE に認証を要求することを検証し、SE 上の暗号化マテリアルがアクセスポリシーにより保護されており対象のユーザーのみがアクセスできることを検証します。 | ✓ | ✓ | ✓ |

### カーネル空間アプリケーション要件

| # | 説明 | L1 | L2 | L3 |
| --  | ---------------------- | - | - | - |
| **3.6.1** | ロードされたカーネルモジュールが暗号で署名および検証されていることを検証します。 | ✓ | ✓ | ✓ |
| **3.6.2** | 実行時に必要なカーネルモジュールのみが有効であることを検証します。 | ✓ | ✓ | ✓ |

## 参考情報
